use store;




/*Part-5(a)*/

create view orderview as 
select cart.itemid,cart.orderid,products.productname,products.price,
(select user.email from user where shopper.shopperId=user.userId),
orders.date,cart.orderstatus

from cart

inner join orders on

cart.orderid=orders.orderid

inner join shopper on

shopper.shopperid=orders.shopperid

inner join products on

products.productid=cart.productid

where DATEDIFF(CURRENT_DATE(),orders.Date)<6;



select * from orderview;



/*Part-5(b)*/

select productname 

from orderview

where orderstatus='shipped';

/

*Part-5(c)*/

select productname,count(productname) as NoOfProductsSold

from orderview

group by productname
order by NoOfProductsSold desc

limit 5;

